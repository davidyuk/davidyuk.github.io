"use strict";(self["webpackChunkaepp_base"]=self["webpackChunkaepp_base"]||[]).push([[116],{70043:function(e,t,a){a.r(t),a.d(t,{default:function(){return P}});var r=function(){var e=this,t=e._self._c;return e.busy?t("div",{staticClass:"spinner"},[t("AeSpinner")],1):t("Page",{staticClass:"redeem-balance",attrs:{"header-fill":"neutral","right-button-to":{name:"transfer"},"right-button-icon-name":"close"}},[t("Guide",{attrs:{slot:"header",template:e.$t("transfer.redeem-balance.guide")},slot:"header"}),t("div",{staticClass:"balance-row"},[t("span",[e._v(e._s(e.$t("transfer.send.amount.balance")))]),t("Balance",{attrs:{balance:e.balance}})],1),e._l(e.accounts,(function(a){return t("ListItemAccount",e._b({key:a.address,attrs:{"border-dark":""},on:{click:function(t){return e.sendToAccount(a.address)}}},"ListItemAccount",a,!1),[t("LeftMore",{attrs:{slot:"right"},slot:"right"})],1)}))],2)},s=[],n=a(96624),o=(a(57658),a(94907)),c=a(70794),i=a(70732),d=a(34502),l=a(12781),u=a(85474),m=a(22400),p=a(75272),h=a(51335),f=a(81572),b=a(3418),y=a(60602),v=a(73142),k=a(54893),g=a(74113),$=a(48764)["Buffer"],Z={components:{AeSpinner:p.Z,Page:h.Z,Guide:f.Z,Balance:b.Z,ListItemAccount:y.Z,LeftMore:v.Z},data:()=>({keypair:null,balance:0,busy:!0}),subscriptions(){return(0,o.Z)(this.$store.state.observables,["accounts"])},mounted(){var e=this;return(0,n.coroutine)((function*(){while(!e.keypair)try{yield e.readQrCode()}catch(t){return e.$router.push({name:"transfer"}),void("Cancelled by user"!==t.message&&(0,m.ac)(t))}e.busy=!1}))()},methods:{readQrCode(){var e=this;return(0,n.coroutine)((function*(){let t;t=yield e.$store.dispatch("modals/open",{name:"readQrCode",title:e.$t("transfer.redeem-balance.scan")});try{t=$.from(t,"hex")}catch(r){(0,m.ac)(r),t=$.from([])}if(64!==t.length)return void(yield e.$store.dispatch("modals/open",{name:"alert",text:e.$t("transfer.redeem-balance.wrong-qr-code")}));const a=i.cv(d.generateKeyPairFromSecret(t).publicKey,"ak");e.balance=(0,c.Z)(yield e.$store.state.sdk.getBalance(a)).shiftedBy(-k.oP),e.balance<g.GR?yield e.$store.dispatch("modals/open",{name:"alert",text:e.$t("transfer.redeem-balance.no-funds")}):e.keypair={address:a,privateKey:t}}))()},sendToAccount(e){var t=this;return(0,n.coroutine)((function*(){t.busy=!0;const{hash:a,tx:{amount:r}}=yield(yield l.Z.compose(u.Z,{methods:{sign:e=>Promise.resolve(d.sign(e,t.keypair.privateKey)),address:()=>Promise.resolve(t.keypair.address)}})({url:t.$store.state.sdkUrl})).transferFunds(1,e);t.$router.push({name:"transfer"}),t.$store.dispatch("modals/open",{name:"spendSuccess",transactionHash:a,amount:(0,c.Z)(r).shiftedBy(-k.oP)})}))()}}},C=Z,_=a(70713),A=(0,_.Z)(C,r,s,!1,null,"15cb73e8",null),P=A.exports}}]);
//# sourceMappingURL=page-redeem.524ff054.js.map